<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Time Series Analysis of Air Pollution and Health Data</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>Time Series Analysis of Air Pollution and Health Data</h1>

<h2>Inputs</h2>

<pre><code class="r">datafile &lt;- &quot;ny.csv&quot;
exposure &lt;- &quot;pm10tmean&quot;
response &lt;- &quot;death&quot;
timevar &lt;- &quot;date&quot;
exposure.lag &lt;- 1
</code></pre>

<h2>Initialization</h2>

<p>Loading required packages. </p>

<pre><code class="r">library(tsModel)
library(moments)
library(xlsx)
library(splines)
library(DSM)
library(digest)
</code></pre>

<h2>Read in Data</h2>

<p>We read in the raw data from the file &#39;ny.csv&#39;.</p>

<h2>Exploratory Data Analysis</h2>

<p>The input data frame had 6940 rows and 6 columns. The variables in the data frame are named: &#39;death&#39;, &#39;pm10tmean&#39;, &#39;date&#39;, &#39;tmpd&#39;, &#39;dptp&#39;, &#39;dow&#39;. The response variable was &#39;death&#39; and the exposure variable was &#39;pm10tmean&#39;. </p>

<pre><code>## Warning: argument is not numeric or logical: returning NA
</code></pre>

<pre><code>## Warning: - not meaningful for factors
</code></pre>

<pre><code>## Warning: argument is not numeric or logical: returning NA
</code></pre>

<pre><code>## Warning: - not meaningful for factors
</code></pre>

<p>We conducted an exploratory analysis of the data. The median of &#39;death&#39; was 181 with an inter-quartile range of 39. The median for the exposure &#39;pm10tmean&#39; was -3.0468 with an inter-quartile range of 12.829.</p>

<p>For the response variable, none of the observations were missing. For the exposure variable, 83.8% of the observations were missing.</p>

<p>Tests for skewness identified possible right skewness in the following variables: &#39;pm10tmean&#39;.</p>

<p>Below is a histogram of the response variable &#39;death&#39;.</p>

<p><img src="figure/response%20histogram.png" alt="plot of chunk response histogram"/> </p>

<p>Below is a histogram of the exposure variable, &#39;pm10tmean&#39;.</p>

<p><img src="figure/exposure%20histogram.png" alt="plot of chunk exposure histogram"/> </p>

<p>Below is a bivariate plot of response versus the exposure.</p>

<p><img src="figure/response%20exposure%20scatterplot.png" alt="plot of chunk response exposure scatterplot"/> </p>

<h2>Model Building</h2>

<p>We fit a base model to the dataset with </p>

<ul>
<li><p>The exposure variable &#39;pm10tmean&#39; at lag 1.</p></li>
<li><p>6 degrees of freedom per year for the smooth function of time.</p></li>
<li><p>6 degrees of freedom for a smooth function of same-day temperature</p></li>
<li><p>6 degrees of freedom for a smooth function of the running mean of temperature at lags 1 through 3</p></li>
<li><p>3 degrees of freedom for a smooth function of same-day dew point temperature</p></li>
<li><p>3 degrees of freedom for a smooth function of the running mean of dew point temperature at lags 1 through 3</p></li>
<li><p>a categorical variable indicating the day of the week.</p></li>
</ul>

<p>For all of the spline smoothers we use natural cubic splines for the basis functions.</p>

<pre><code>## glm(formula = death ~ dow + ns(date, 19 * 6) + ns(tmpd, 6) + 
##     ns(runMean(tmpd, 1:3), 6) + ns(dptp, 3) + ns(runMean(dptp, 
##     1:3), 3) + Lag(pm10tmean, 1), family = poisson, data = as(d0, 
##     &quot;data.frame&quot;))
</code></pre>

<p>A key aspect of the model building process involves selecting the optimal degrees of freedom for the smooth function of time to adjust for unmeasured confounding. The approach is based on the methods described in Dominici et al. (2004) and Peng et al. (2006). Essentially, we choose the degrees of freedom per year that optimally predicts the variation in the exposure variable (&#39;pm10tmean&#39;). The fit of the model to the data is measured via AIC and the range of degrees of freedom per year that we search over is between 2 and 20 per year. </p>

<p>The optimal number of degrees of freedom per year for the smooth
function of time is estimated to be 5.</p>

<p>Below is a plot showing the AIC values versus the number of degrees of freedom per year in the smooth function of time.</p>

<p><img src="figure/plotting%20AIC%20values.png" alt="plot of chunk plotting AIC values"/> </p>

<h2>Model Fitting</h2>

<p>With the selected degrees of freedom per year, we fit the final model to the data.</p>

<pre><code>## glm(formula = death ~ dow + ns(date, 19 * 5) + ns(tmpd, 6) + 
##     ns(runMean(tmpd, 1:3), 6) + ns(dptp, 3) + ns(runMean(dptp, 
##     1:3), 3) + Lag(pm10tmean, 1), family = poisson, data = as(d0, 
##     &quot;data.frame&quot;))
</code></pre>

<h2>Results</h2>

<p>We found that a 10 unit increase in the exposure &#39;pm10tmean&#39; was associated with a 0.698 (95% CI: 0.2314, 1.167) percent increase in the response &#39;death&#39;. This result was  statistically significant at the level 0.05 (p = 0.003329).</p>

<h2>Sensitivity Analysis</h2>

<p>Run sensitivity analysis with respect to the degrees of freedom for
the smooth function of time.</p>

<p><img src="figure/plot%20sensitivity%20analysis.png" alt="plot of chunk plot sensitivity analysis"/> </p>

<p>After fitting the final model, we examine the leverages and Cook&#39;s distance to identify potentially influential points that may affect the estimation of the exposure regression coefficient.</p>

<p>In this dataset we identified 10 potentially influential points, given the final fitted model. Below we plot the exposure regression coefficient after removing each influential point individually and after removing all of them simultaneously (the x-axis shows the observation row labels from the original data frame).</p>

<p><img src="figure/plot%20influental%20points%20anlaysis.png" alt="plot of chunk plot influental points anlaysis"/> </p>

<h2>Outputs</h2>

<p>The final output is stored in the file <strong>ny.csv-output.rda</strong> which contains the objects: &#39;final&#39;, &#39;response&#39;, &#39;exposure&#39;, &#39;exposure.lag&#39;, &#39;timevar&#39;.</p>

<p>The SHA-1 hash for the output file is: 6d268e106a3dce3bc78733393f5be6ef3ecc0659.</p>

<h2>Appendix</h2>

<h3>Summary of the final fitted model.</h3>

<pre><code>## 
## Call:
## glm(formula = death ~ dow + ns(date, 19 * 5) + ns(tmpd, 6) + 
##     ns(runMean(tmpd, 1:3), 6) + ns(dptp, 3) + ns(runMean(dptp, 
##     1:3), 3) + Lag(pm10tmean, 1), family = poisson, data = as(d0, 
##     &quot;data.frame&quot;))
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -3.461  -0.683  -0.039   0.669   4.416  
## 
## Coefficients: (2 not defined because of singularities)
##                             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                 5.503965   0.059088   93.15  &lt; 2e-16
## dowMonday                   0.015388   0.008357    1.84  0.06556
## dowSaturday                -0.010907   0.008315   -1.31  0.18962
## dowSunday                  -0.015101   0.008305   -1.82  0.06902
## dowThursday                -0.008487   0.008264   -1.03  0.30440
## dowTuesday                  0.004280   0.008312    0.51  0.60665
## dowWednesday               -0.009176   0.008224   -1.12  0.26457
## ns(date, 19 * 5)1          -0.066276   0.053632   -1.24  0.21655
## ns(date, 19 * 5)2          -0.270448   0.071948   -3.76  0.00017
## ns(date, 19 * 5)3           0.090100   0.060524    1.49  0.13657
## ns(date, 19 * 5)4          -0.154098   0.060425   -2.55  0.01077
## ns(date, 19 * 5)5           0.214739   0.058726    3.66  0.00026
## ns(date, 19 * 5)6          -0.298046   0.063531   -4.69  2.7e-06
## ns(date, 19 * 5)7          -0.093790   0.067956   -1.38  0.16754
## ns(date, 19 * 5)8          -0.144898   0.063229   -2.29  0.02193
## ns(date, 19 * 5)9           0.081213   0.059486    1.37  0.17218
## ns(date, 19 * 5)10         -0.062613   0.059720   -1.05  0.29443
## ns(date, 19 * 5)11         -0.167607   0.063785   -2.63  0.00860
## ns(date, 19 * 5)12         -0.168059   0.067445   -2.49  0.01271
## ns(date, 19 * 5)13         -0.171616   0.062916   -2.73  0.00638
## ns(date, 19 * 5)14          0.160479   0.058870    2.73  0.00641
## ns(date, 19 * 5)15         -0.179847   0.060710   -2.96  0.00305
## ns(date, 19 * 5)16         -0.109682   0.063254   -1.73  0.08292
## ns(date, 19 * 5)17         -0.249679   0.069367   -3.60  0.00032
## ns(date, 19 * 5)18         -0.174785   0.062511   -2.80  0.00517
## ns(date, 19 * 5)19          0.052691   0.059834    0.88  0.37852
## ns(date, 19 * 5)20         -0.193851   0.061207   -3.17  0.00154
## ns(date, 19 * 5)21         -0.108019   0.064443   -1.68  0.09370
## ns(date, 19 * 5)22         -0.365146   0.068978   -5.29  1.2e-07
## ns(date, 19 * 5)23         -0.104491   0.063546   -1.64  0.10011
## ns(date, 19 * 5)24          0.025115   0.059381    0.42  0.67234
## ns(date, 19 * 5)25         -0.107982   0.060522   -1.78  0.07440
## ns(date, 19 * 5)26         -0.239815   0.064134   -3.74  0.00018
## ns(date, 19 * 5)27         -0.168838   0.068636   -2.46  0.01390
## ns(date, 19 * 5)28         -0.236672   0.062807   -3.77  0.00016
## ns(date, 19 * 5)29          0.038618   0.059470    0.65  0.51610
## ns(date, 19 * 5)30          0.100602   0.058960    1.71  0.08796
## ns(date, 19 * 5)31         -0.238430   0.065104   -3.66  0.00025
## ns(date, 19 * 5)32         -0.274936   0.070327   -3.91  9.3e-05
## ns(date, 19 * 5)33         -0.103588   0.065289   -1.59  0.11260
## ns(date, 19 * 5)34         -0.057028   0.061250   -0.93  0.35182
## ns(date, 19 * 5)35         -0.170622   0.060982   -2.80  0.00514
## ns(date, 19 * 5)36         -0.188537   0.065899   -2.86  0.00422
## ns(date, 19 * 5)37         -0.233396   0.067838   -3.44  0.00058
## ns(date, 19 * 5)38         -0.242459   0.065373   -3.71  0.00021
## ns(date, 19 * 5)39          0.130924   0.059874    2.19  0.02877
## ns(date, 19 * 5)40         -0.195709   0.061350   -3.19  0.00142
## ns(date, 19 * 5)41         -0.181094   0.064454   -2.81  0.00496
## ns(date, 19 * 5)42         -0.275602   0.069632   -3.96  7.6e-05
## ns(date, 19 * 5)43         -0.222815   0.065189   -3.42  0.00063
## ns(date, 19 * 5)44         -0.003452   0.060774   -0.06  0.95471
## ns(date, 19 * 5)45         -0.279661   0.061781   -4.53  6.0e-06
## ns(date, 19 * 5)46         -0.135883   0.063308   -2.15  0.03184
## ns(date, 19 * 5)47         -0.368471   0.063444   -5.81  6.3e-09
## ns(date, 19 * 5)48         -0.207586   0.062868   -3.30  0.00096
## ns(date, 19 * 5)49          0.000189   0.060400    0.00  0.99751
## ns(date, 19 * 5)50         -0.299292   0.063247   -4.73  2.2e-06
## ns(date, 19 * 5)51         -0.233257   0.066169   -3.53  0.00042
## ns(date, 19 * 5)52         -0.466132   0.071451   -6.52  6.9e-11
## ns(date, 19 * 5)53         -0.273817   0.065355   -4.19  2.8e-05
## ns(date, 19 * 5)54         -0.143657   0.061989   -2.32  0.02048
## ns(date, 19 * 5)55         -0.211822   0.063409   -3.34  0.00084
## ns(date, 19 * 5)56         -0.419863   0.067341   -6.23  4.5e-10
## ns(date, 19 * 5)57         -0.357929   0.071863   -4.98  6.3e-07
## ns(date, 19 * 5)58         -0.406725   0.066912   -6.08  1.2e-09
## ns(date, 19 * 5)59          0.093446   0.060663    1.54  0.12346
## ns(date, 19 * 5)60         -0.290277   0.062958   -4.61  4.0e-06
## ns(date, 19 * 5)61         -0.351035   0.067251   -5.22  1.8e-07
## ns(date, 19 * 5)62         -0.396583   0.072258   -5.49  4.1e-08
## ns(date, 19 * 5)63         -0.432524   0.067541   -6.40  1.5e-10
## ns(date, 19 * 5)64          0.013487   0.061611    0.22  0.82672
## ns(date, 19 * 5)65         -0.281047   0.063338   -4.44  9.1e-06
## ns(date, 19 * 5)66         -0.322595   0.066787   -4.83  1.4e-06
## ns(date, 19 * 5)67         -0.394819   0.071779   -5.50  3.8e-08
## ns(date, 19 * 5)68         -0.319496   0.067253   -4.75  2.0e-06
## ns(date, 19 * 5)69         -0.101894   0.062887   -1.62  0.10517
## ns(date, 19 * 5)70         -0.397170   0.064134   -6.19  5.9e-10
## ns(date, 19 * 5)71         -0.210689   0.067405   -3.13  0.00177
## ns(date, 19 * 5)72         -0.497948   0.071832   -6.93  4.1e-12
## ns(date, 19 * 5)73         -0.312568   0.067266   -4.65  3.4e-06
## ns(date, 19 * 5)74         -0.192018   0.062960   -3.05  0.00229
## ns(date, 19 * 5)75         -0.216567   0.064130   -3.38  0.00073
## ns(date, 19 * 5)76         -0.421882   0.067357   -6.26  3.8e-10
## ns(date, 19 * 5)77         -0.488674   0.073508   -6.65  3.0e-11
## ns(date, 19 * 5)78         -0.276300   0.066396   -4.16  3.2e-05
## ns(date, 19 * 5)79         -0.161703   0.062947   -2.57  0.01020
## ns(date, 19 * 5)80         -0.349080   0.064299   -5.43  5.7e-08
## ns(date, 19 * 5)81         -0.403827   0.068023   -5.94  2.9e-09
## ns(date, 19 * 5)82         -0.403626   0.073749   -5.47  4.4e-08
## ns(date, 19 * 5)83         -0.371557   0.067434   -5.51  3.6e-08
## ns(date, 19 * 5)84         -0.132312   0.063605   -2.08  0.03750
## ns(date, 19 * 5)85         -0.381199   0.065354   -5.83  5.4e-09
## ns(date, 19 * 5)86         -0.415265   0.068998   -6.02  1.8e-09
## ns(date, 19 * 5)87         -0.482824   0.073381   -6.58  4.7e-11
## ns(date, 19 * 5)88         -0.387909   0.070737   -5.48  4.2e-08
## ns(date, 19 * 5)89         -0.152684   0.075111   -2.03  0.04207
## ns(date, 19 * 5)90         -0.183488   0.114617   -1.60  0.10940
## ns(date, 19 * 5)91         -0.956219   0.435297   -2.20  0.02804
## ns(date, 19 * 5)92         43.442409  29.768256    1.46  0.14447
## ns(date, 19 * 5)93          0.346365   0.286957    1.21  0.22742
## ns(date, 19 * 5)94                NA         NA      NA       NA
## ns(date, 19 * 5)95                NA         NA      NA       NA
## ns(tmpd, 6)1               -0.017789   0.053605   -0.33  0.74000
## ns(tmpd, 6)2               -0.028780   0.059947   -0.48  0.63116
## ns(tmpd, 6)3                0.047275   0.057883    0.82  0.41408
## ns(tmpd, 6)4                0.043043   0.045327    0.95  0.34231
## ns(tmpd, 6)5                0.088156   0.112951    0.78  0.43511
## ns(tmpd, 6)6                0.192703   0.050456    3.82  0.00013
## ns(runMean(tmpd, 1:3), 6)1 -0.084392   0.056005   -1.51  0.13185
## ns(runMean(tmpd, 1:3), 6)2 -0.071647   0.060930   -1.18  0.23963
## ns(runMean(tmpd, 1:3), 6)3 -0.043437   0.059861   -0.73  0.46807
## ns(runMean(tmpd, 1:3), 6)4 -0.107348   0.049996   -2.15  0.03178
## ns(runMean(tmpd, 1:3), 6)5  0.021962   0.110028    0.20  0.84179
## ns(runMean(tmpd, 1:3), 6)6  0.183190   0.059040    3.10  0.00192
## ns(dptp, 3)1                0.023501   0.022687    1.04  0.30025
## ns(dptp, 3)2               -0.022449   0.063684   -0.35  0.72446
## ns(dptp, 3)3                0.016517   0.025382    0.65  0.51522
## ns(runMean(dptp, 1:3), 3)1 -0.047993   0.031044   -1.55  0.12212
## ns(runMean(dptp, 1:3), 3)2 -0.070639   0.079507   -0.89  0.37429
## ns(runMean(dptp, 1:3), 3)3 -0.134960   0.032597   -4.14  3.5e-05
## Lag(pm10tmean, 1)           0.000696   0.000237    2.94  0.00333
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 4402.6  on 1123  degrees of freedom
## Residual deviance: 1303.5  on 1005  degrees of freedom
##   (5816 observations deleted due to missingness)
## AIC: 9460
## 
## Number of Fisher Scoring iterations: 4
</code></pre>

<h3>R session information</h3>

<pre><code>## R version 3.0.1 (2013-05-16)
## Platform: x86_64-apple-darwin10.8.0 (64-bit)
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] splines   stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
## [1] digest_0.6.3   DSM_0.1        xlsx_0.5.1     xlsxjars_0.5.0
## [5] rJava_0.9-4    moments_0.13   tsModel_0.6    knitr_1.2     
## 
## loaded via a namespace (and not attached):
## [1] evaluate_0.4.4 formatR_0.8    stringr_0.6.2  tools_3.0.1
</code></pre>

<p>SHA-1 hashes for the input data file and the original data frame.</p>

<pre><code>## &#39;ny.csv&#39;: 8a67c16b9a94f5341cdec4d95ec6d55cb9cb8f37
</code></pre>

<pre><code>## data frame: 5f176a7dd366624a963820795acee2c8a8a139ba
</code></pre>

<p>This analysis started on 2013-07-16 14:49:05 and was completed on
2013-07-16 14:49:12.</p>

</body>

</html>

